#!/usr/bin/env sh
set -euo pipefail

cd "$(dirname "$0")/.." || exit 1

echo "ğŸ§ª pre-push: running web tests (unit) ..."
(cd web && npm run test)

if [ "${SKIP_PLAYWRIGHT:-0}" = "1" ]; then
  echo "â© skipping Playwright (SKIP_PLAYWRIGHT=1)"
else
  echo "ğŸ­ pre-push: Playwright smoke ..."
  (cd web && npx playwright test --workers=2 --retries=1)
fi

echo "ğŸ¦€ pre-push: cargo test ..."
(cd server && cargo test)

echo "âœ… pre-push checks passed"
